digraph test_script {
  subgraph malloc_checker {
    ptr_unchecked [label=<ptr.unchecked>];
    ptr_null [label=<ptr.null>];
    ptr_start [label=<ptr.start>];
    ptr_nonnull [label=<ptr.nonnull>];
    ptr_free [label=<ptr.free>];

    ptr_unchecked -> ptr_unchecked [label=<{ ptr = malloc() }>];
    ptr_null -> ptr_unchecked [label=<{ ptr = malloc() }>];
    ptr_start -> ptr_unchecked [label=<{ ptr = malloc() }>];
    ptr_nonnull -> ptr_unchecked [label=<{ ptr = malloc() }>];
    ptr_free -> ptr_unchecked [label=<{ ptr = malloc() }>];
    ptr_unchecked -> ptr_null [label=<{ ptr = 0 }>];
    ptr_null -> ptr_null [label=<{ ptr = 0 }>];
    ptr_start -> ptr_null [label=<{ ptr = 0 }>];
    ptr_nonnull -> ptr_null [label=<{ ptr = 0 }>];
    ptr_free -> ptr_null [label=<{ ptr = 0 }>];
    ptr_unchecked -> ptr_null [label=<{ ptr == 0 } is True>];
    ptr_unchecked -> ptr_nonnull [label=<{ ptr == 0 } is False>];
    ptr_unchecked -> ptr_nonnull [label=<{ ptr != 0 } is True>];
    ptr_unchecked -> ptr_null [label=<{ ptr != 0 } is False>];
    ptr_null -> ptr_null [label=<{ ptr == 0 } is True>];
    ptr_null -> ptr_nonnull [label=<{ ptr == 0 } is False>];
    ptr_null -> ptr_nonnull [label=<{ ptr != 0 } is True>];
    ptr_null -> ptr_null [label=<{ ptr != 0 } is False>];
    ptr_start -> ptr_null [label=<{ ptr == 0 } is True>];
    ptr_start -> ptr_nonnull [label=<{ ptr == 0 } is False>];
    ptr_start -> ptr_nonnull [label=<{ ptr != 0 } is True>];
    ptr_start -> ptr_null [label=<{ ptr != 0 } is False>];
    ptr_nonnull -> ptr_null [label=<{ ptr == 0 } is True>];
    ptr_nonnull -> ptr_nonnull [label=<{ ptr == 0 } is False>];
    ptr_nonnull -> ptr_nonnull [label=<{ ptr != 0 } is True>];
    ptr_nonnull -> ptr_null [label=<{ ptr != 0 } is False>];
    ptr_free -> ptr_null [label=<{ ptr == 0 } is True>];
    ptr_free -> ptr_nonnull [label=<{ ptr == 0 } is False>];
    ptr_free -> ptr_nonnull [label=<{ ptr != 0 } is True>];
    ptr_free -> ptr_null [label=<{ ptr != 0 } is False>];
    ptr_unchecked -> ptr_unchecked [label=<{ *ptr }: 
            error(&apos;dereference of possibly-NULL pointer %s&apos; % ptr,
                  # &quot;CWE-690: Unchecked Return Value to NULL Pointer Dereference&quot;
                  cwe=&apos;CWE-690&apos;)
         >];
    ptr_unchecked -> ptr_nonnull [label=<{ *ptr }>];
    ptr_null -> ptr_null [label=<{ *ptr }: 
            error(&apos;dereference of NULL pointer %s&apos; % ptr,
                  # &quot;CWE-690: Unchecked Return Value to NULL Pointer Dereference&quot;
                  cwe=&apos;CWE-690&apos;)
         >];
    ptr_null -> ptr_stop [label=<{ *ptr }>];
    ptr_start -> ptr_free [label=<{ free(ptr) } >];
    ptr_unchecked -> ptr_free [label=<{ free(ptr) } >];
    ptr_null -> ptr_free [label=<{ free(ptr) } >];
    ptr_nonnull -> ptr_free [label=<{ free(ptr) } >];
    ptr_free -> ptr_free [label=<{ free(ptr) } : 
                error(&apos;double-free of %s&apos; % ptr,
                      # &quot;CWE-415: Double Free&quot;
                      cwe=&apos;CWE-415&apos;)
             >];
    ptr_free -> ptr_stop [label=<{ free(ptr) } >];
    ptr_free -> ptr_free [label=<{ ptr }: 
                error(&apos;use-after-free of %s&apos; % ptr,
                      # &quot;CWE-416: Use After Free&quot;
                      cwe=&apos;CWE-416&apos;)
             >];
    ptr_free -> ptr_stop [label=<{ ptr }>];
    ptr_unchecked -> ptr_unchecked [label=<$arg_must_not_be_null$: 
            error(&apos;possibly-NULL pointer %s passed as argument %i to %s&apos;
                  % (ptr, argnumber, function),
                  # &quot;CWE-690: Unchecked Return Value to NULL Pointer Dereference&quot;
                  cwe=&apos;CWE-690&apos;)
          >];
    ptr_unchecked -> ptr_nonnull [label=<$arg_must_not_be_null$>];
    ptr_null -> ptr_null [label=<$arg_must_not_be_null$: 
            error(&apos;NULL pointer %s passed as argument %i to %s&apos;
                  % (ptr, argnumber, function),
                  # &quot;CWE-690: Unchecked Return Value to NULL Pointer Dereference&quot;
                  cwe=&apos;CWE-690&apos;)
         >];
    ptr_null -> ptr_stop [label=<$arg_must_not_be_null$>];
  }
}

